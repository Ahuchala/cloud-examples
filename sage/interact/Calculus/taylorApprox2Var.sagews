︠ba61ded8-c9e2-4480-8d98-efa9b170f679︠
var('x y')
var('xx yy')
G = sin(xx^2 + yy^2) * cos(yy) * exp(-0.5*(xx^2+yy^2))
def F(x,y):
    return G.subs(xx=x).subs(yy=y)
plotF = plot3d(F, (0.4, 2), (0.4, 2), adaptive=True, color='blue')
@interact
def _(x0=(0.5,1.5), y0=(0.5, 1.5),
      order=(1..10)):
    F0 = float(G.subs(xx=x0).subs(yy=y0))
    P = (x0, y0, F0)
    dot = point3d(P, size=15, color='red')
    plot = dot + plotF
    approx = F0
    for n in range(1, order+1):
        for i in range(n+1):
            if i == 0:
                deriv = G.diff(yy, n)
            elif i == n:
                deriv = G.diff(xx, n)
            else:
                deriv = G.diff(xx, i).diff(yy, n-i)
            deriv = float(deriv.subs(xx=x0).subs(yy=y0))
            coeff = binomial(n, i)/factorial(n)
            approx += coeff * deriv * (x-x0)^i * (y-y0)^(n-i)
    plot += plot3d(approx, (x, 0.4, 1.6), 
             (y, 0.4, 1.6), color='red', opacity=0.7)
    html('$F(x,y) = e^{-(x^2+y^2)/2} \\cos(y) \\sin(x^2+y^2)$')
    show(plot)
︡2c10f3da-6de4-4d42-92f3-530bbf98fc0c︡{"stdout":"(x, y)\n"}︡{"stdout":"(xx, yy)\n"}︡{"interact":{"style":"None","flicker":false,"layout":[[["x0",12,null]],[["y0",12,null]],[["order",12,null]],[["",12,null]]],"id":"cb1b6dff-79a8-48b2-a5ad-76bc7d237a3e","controls":[{"control_type":"slider","default":0,"var":"x0","width":null,"vals":["0.500000000000000","0.502000000000000","0.504000000000000","0.506000000000000","0.508000000000000","0.510000000000000","0.512000000000000","0.514000000000000","0.516000000000000","0.518000000000000","0.520000000000000","0.522000000000000","0.524000000000000","0.526000000000000","0.528000000000000","0.530000000000000","0.532000000000000","0.534000000000000","0.536000000000000","0.538000000000000","0.540000000000000","0.542000000000000","0.544000000000000","0.546000000000000","0.548000000000000","0.550000000000000","0.552000000000000","0.554000000000000","0.556000000000000","0.558000000000000","0.560000000000000","0.562000000000000","0.564000000000000","0.566000000000000","0.568000000000000","0.570000000000000","0.572000000000000","0.574000000000000","0.576000000000000","0.578000000000000","0.580000000000000","0.582000000000000","0.584000000000000","0.586000000000000","0.588000000000000","0.590000000000000","0.592000000000000","0.594000000000000","0.596000000000000","0.598000000000000","0.600000000000000","0.602000000000000","0.604000000000000","0.606000000000000","0.608000000000000","0.610000000000000","0.612000000000000","0.614000000000000","0.616000000000000","0.618000000000000","0.620000000000000","0.622000000000000","0.624000000000000","0.626000000000000","0.628000000000000","0.630000000000000","0.632000000000000","0.634000000000000","0.636000000000000","0.638000000000000","0.640000000000000","0.642000000000000","0.644000000000000","0.646000000000000","0.648000000000000","0.650000000000000","0.652000000000000","0.654000000000000","0.656000000000000","0.658000000000000","0.660000000000000","0.662000000000000","0.664000000000000","0.666000000000000","0.668000000000000","0.670000000000000","0.672000000000000","0.674000000000000","0.676000000000000","0.678000000000000","0.680000000000000","0.682000000000000","0.684000000000000","0.686000000000000","0.688000000000000","0.690000000000000","0.692000000000000","0.694000000000000","0.696000000000000","0.698000000000000","0.700000000000000","0.702000000000000","0.704000000000000","0.706000000000000","0.708000000000000","0.710000000000000","0.712000000000000","0.714000000000000","0.716000000000000","0.718000000000000","0.720000000000000","0.722000000000000","0.724000000000000","0.726000000000000","0.728000000000000","0.730000000000000","0.732000000000000","0.734000000000000","0.736000000000000","0.738000000000000","0.740000000000000","0.742000000000000","0.744000000000000","0.746000000000000","0.748000000000000","0.750000000000000","0.752000000000000","0.754000000000000","0.756000000000000","0.758000000000000","0.760000000000000","0.762000000000000","0.764000000000000","0.766000000000000","0.768000000000000","0.770000000000000","0.772000000000000","0.774000000000000","0.776000000000000","0.778000000000000","0.780000000000000","0.782000000000000","0.784000000000000","0.786000000000000","0.788000000000000","0.790000000000000","0.792000000000000","0.794000000000000","0.796000000000000","0.798000000000000","0.800000000000000","0.802000000000000","0.804000000000000","0.806000000000000","0.808000000000000","0.810000000000000","0.812000000000000","0.814000000000000","0.816000000000000","0.818000000000000","0.820000000000000","0.822000000000000","0.824000000000000","0.826000000000000","0.828000000000000","0.830000000000000","0.832000000000000","0.834000000000000","0.836000000000000","0.838000000000000","0.840000000000000","0.842000000000000","0.844000000000000","0.846000000000000","0.848000000000000","0.850000000000000","0.852000000000000","0.854000000000000","0.856000000000000","0.858000000000000","0.860000000000000","0.862000000000000","0.864000000000000","0.866000000000000","0.868000000000000","0.870000000000000","0.872000000000000","0.874000000000000","0.876000000000000","0.878000000000000","0.880000000000000","0.882000000000000","0.884000000000000","0.886000000000000","0.888000000000000","0.890000000000000","0.892000000000000","0.894000000000000","0.896000000000000","0.898000000000000","0.900000000000000","0.902000000000000","0.904000000000000","0.906000000000000","0.908000000000000","0.910000000000000","0.912000000000000","0.914000000000000","0.916000000000000","0.918000000000000","0.920000000000000","0.922000000000000","0.924000000000000","0.926000000000000","0.928000000000000","0.930000000000000","0.932000000000000","0.934000000000000","0.936000000000000","0.938000000000000","0.940000000000000","0.942000000000000","0.944000000000000","0.946000000000000","0.948000000000000","0.950000000000000","0.952000000000000","0.954000000000000","0.956000000000000","0.958000000000000","0.960000000000000","0.962000000000000","0.964000000000000","0.966000000000000","0.968000000000000","0.970000000000000","0.972000000000000","0.974000000000000","0.976000000000000","0.978000000000000","0.980000000000000","0.982000000000000","0.984000000000000","0.986000000000000","0.988000000000000","0.990000000000000","0.992000000000000","0.994000000000000","0.996000000000000","0.998000000000000","1.00000000000000","1.00200000000000","1.00400000000000","1.00600000000000","1.00800000000000","1.01000000000000","1.01200000000000","1.01400000000000","1.01600000000000","1.01800000000000","1.02000000000000","1.02200000000000","1.02400000000000","1.02600000000000","1.02800000000000","1.03000000000000","1.03200000000000","1.03400000000000","1.03600000000000","1.03800000000000","1.04000000000000","1.04200000000000","1.04400000000000","1.04600000000000","1.04800000000000","1.05000000000000","1.05200000000000","1.05400000000000","1.05600000000000","1.05800000000000","1.06000000000000","1.06200000000000","1.06400000000000","1.06600000000000","1.06800000000000","1.07000000000000","1.07200000000000","1.07400000000000","1.07600000000000","1.07800000000000","1.08000000000000","1.08200000000000","1.08400000000000","1.08600000000000","1.08800000000000","1.09000000000000","1.09200000000000","1.09400000000000","1.09600000000000","1.09800000000000","1.10000000000000","1.10200000000000","1.10400000000000","1.10600000000000","1.10800000000000","1.11000000000000","1.11200000000000","1.11400000000000","1.11600000000000","1.11800000000000","1.12000000000000","1.12200000000000","1.12400000000000","1.12600000000000","1.12800000000000","1.13000000000000","1.13200000000000","1.13400000000000","1.13600000000000","1.13800000000000","1.14000000000000","1.14200000000000","1.14400000000000","1.14600000000000","1.14800000000000","1.15000000000000","1.15200000000000","1.15400000000000","1.15600000000000","1.15800000000000","1.16000000000000","1.16200000000000","1.16400000000000","1.16600000000000","1.16800000000000","1.17000000000000","1.17200000000000","1.17400000000000","1.17600000000000","1.17800000000000","1.18000000000000","1.18200000000000","1.18400000000000","1.18600000000000","1.18800000000000","1.19000000000000","1.19200000000000","1.19400000000000","1.19600000000000","1.19800000000000","1.20000000000000","1.20200000000000","1.20400000000000","1.20600000000000","1.20800000000000","1.21000000000000","1.21200000000000","1.21400000000000","1.21600000000000","1.21800000000000","1.22000000000000","1.22200000000000","1.22400000000000","1.22600000000000","1.22800000000000","1.23000000000000","1.23200000000000","1.23400000000000","1.23600000000000","1.23800000000000","1.24000000000000","1.24200000000000","1.24400000000000","1.24600000000000","1.24800000000000","1.25000000000000","1.25200000000000","1.25400000000000","1.25600000000000","1.25800000000000","1.26000000000000","1.26200000000000","1.26400000000000","1.26600000000000","1.26800000000000","1.27000000000000","1.27200000000000","1.27400000000000","1.27600000000000","1.27800000000000","1.28000000000000","1.28200000000000","1.28400000000000","1.28600000000000","1.28800000000000","1.29000000000000","1.29200000000000","1.29400000000000","1.29600000000000","1.29800000000000","1.30000000000000","1.30200000000000","1.30400000000000","1.30600000000000","1.30800000000000","1.31000000000000","1.31200000000000","1.31400000000000","1.31600000000000","1.31800000000000","1.32000000000000","1.32200000000000","1.32400000000000","1.32600000000000","1.32800000000000","1.33000000000000","1.33200000000000","1.33400000000000","1.33600000000000","1.33800000000000","1.34000000000000","1.34200000000000","1.34400000000000","1.34600000000000","1.34800000000000","1.35000000000000","1.35200000000000","1.35400000000000","1.35600000000000","1.35800000000000","1.36000000000000","1.36200000000000","1.36400000000000","1.36600000000000","1.36800000000000","1.37000000000000","1.37200000000000","1.37400000000000","1.37600000000000","1.37800000000000","1.38000000000000","1.38200000000000","1.38400000000000","1.38600000000000","1.38800000000000","1.39000000000000","1.39200000000000","1.39400000000000","1.39600000000000","1.39800000000000","1.40000000000000","1.40200000000000","1.40400000000000","1.40600000000000","1.40800000000000","1.41000000000000","1.41200000000000","1.41400000000000","1.41600000000000","1.41800000000000","1.42000000000000","1.42200000000000","1.42400000000000","1.42600000000000","1.42800000000000","1.43000000000000","1.43200000000000","1.43400000000000","1.43600000000000","1.43800000000000","1.44000000000000","1.44200000000000","1.44400000000000","1.44600000000000","1.44800000000000","1.45000000000000","1.45200000000000","1.45400000000000","1.45600000000000","1.45800000000000","1.46000000000000","1.46200000000000","1.46400000000000","1.46600000000000","1.46800000000000","1.47000000000000","1.47200000000000","1.47400000000000","1.47600000000000","1.47800000000000","1.48000000000000","1.48200000000000","1.48400000000000","1.48600000000000","1.48800000000000","1.49000000000000","1.49200000000000","1.49400000000000","1.49600000000000","1.49800000000000","1.50000000000000"],"animate":true,"label":"x0","display_value":true},{"control_type":"slider","default":0,"var":"y0","width":null,"vals":["0.500000000000000","0.502000000000000","0.504000000000000","0.506000000000000","0.508000000000000","0.510000000000000","0.512000000000000","0.514000000000000","0.516000000000000","0.518000000000000","0.520000000000000","0.522000000000000","0.524000000000000","0.526000000000000","0.528000000000000","0.530000000000000","0.532000000000000","0.534000000000000","0.536000000000000","0.538000000000000","0.540000000000000","0.542000000000000","0.544000000000000","0.546000000000000","0.548000000000000","0.550000000000000","0.552000000000000","0.554000000000000","0.556000000000000","0.558000000000000","0.560000000000000","0.562000000000000","0.564000000000000","0.566000000000000","0.568000000000000","0.570000000000000","0.572000000000000","0.574000000000000","0.576000000000000","0.578000000000000","0.580000000000000","0.582000000000000","0.584000000000000","0.586000000000000","0.588000000000000","0.590000000000000","0.592000000000000","0.594000000000000","0.596000000000000","0.598000000000000","0.600000000000000","0.602000000000000","0.604000000000000","0.606000000000000","0.608000000000000","0.610000000000000","0.612000000000000","0.614000000000000","0.616000000000000","0.618000000000000","0.620000000000000","0.622000000000000","0.624000000000000","0.626000000000000","0.628000000000000","0.630000000000000","0.632000000000000","0.634000000000000","0.636000000000000","0.638000000000000","0.640000000000000","0.642000000000000","0.644000000000000","0.646000000000000","0.648000000000000","0.650000000000000","0.652000000000000","0.654000000000000","0.656000000000000","0.658000000000000","0.660000000000000","0.662000000000000","0.664000000000000","0.666000000000000","0.668000000000000","0.670000000000000","0.672000000000000","0.674000000000000","0.676000000000000","0.678000000000000","0.680000000000000","0.682000000000000","0.684000000000000","0.686000000000000","0.688000000000000","0.690000000000000","0.692000000000000","0.694000000000000","0.696000000000000","0.698000000000000","0.700000000000000","0.702000000000000","0.704000000000000","0.706000000000000","0.708000000000000","0.710000000000000","0.712000000000000","0.714000000000000","0.716000000000000","0.718000000000000","0.720000000000000","0.722000000000000","0.724000000000000","0.726000000000000","0.728000000000000","0.730000000000000","0.732000000000000","0.734000000000000","0.736000000000000","0.738000000000000","0.740000000000000","0.742000000000000","0.744000000000000","0.746000000000000","0.748000000000000","0.750000000000000","0.752000000000000","0.754000000000000","0.756000000000000","0.758000000000000","0.760000000000000","0.762000000000000","0.764000000000000","0.766000000000000","0.768000000000000","0.770000000000000","0.772000000000000","0.774000000000000","0.776000000000000","0.778000000000000","0.780000000000000","0.782000000000000","0.784000000000000","0.786000000000000","0.788000000000000","0.790000000000000","0.792000000000000","0.794000000000000","0.796000000000000","0.798000000000000","0.800000000000000","0.802000000000000","0.804000000000000","0.806000000000000","0.808000000000000","0.810000000000000","0.812000000000000","0.814000000000000","0.816000000000000","0.818000000000000","0.820000000000000","0.822000000000000","0.824000000000000","0.826000000000000","0.828000000000000","0.830000000000000","0.832000000000000","0.834000000000000","0.836000000000000","0.838000000000000","0.840000000000000","0.842000000000000","0.844000000000000","0.846000000000000","0.848000000000000","0.850000000000000","0.852000000000000","0.854000000000000","0.856000000000000","0.858000000000000","0.860000000000000","0.862000000000000","0.864000000000000","0.866000000000000","0.868000000000000","0.870000000000000","0.872000000000000","0.874000000000000","0.876000000000000","0.878000000000000","0.880000000000000","0.882000000000000","0.884000000000000","0.886000000000000","0.888000000000000","0.890000000000000","0.892000000000000","0.894000000000000","0.896000000000000","0.898000000000000","0.900000000000000","0.902000000000000","0.904000000000000","0.906000000000000","0.908000000000000","0.910000000000000","0.912000000000000","0.914000000000000","0.916000000000000","0.918000000000000","0.920000000000000","0.922000000000000","0.924000000000000","0.926000000000000","0.928000000000000","0.930000000000000","0.932000000000000","0.934000000000000","0.936000000000000","0.938000000000000","0.940000000000000","0.942000000000000","0.944000000000000","0.946000000000000","0.948000000000000","0.950000000000000","0.952000000000000","0.954000000000000","0.956000000000000","0.958000000000000","0.960000000000000","0.962000000000000","0.964000000000000","0.966000000000000","0.968000000000000","0.970000000000000","0.972000000000000","0.974000000000000","0.976000000000000","0.978000000000000","0.980000000000000","0.982000000000000","0.984000000000000","0.986000000000000","0.988000000000000","0.990000000000000","0.992000000000000","0.994000000000000","0.996000000000000","0.998000000000000","1.00000000000000","1.00200000000000","1.00400000000000","1.00600000000000","1.00800000000000","1.01000000000000","1.01200000000000","1.01400000000000","1.01600000000000","1.01800000000000","1.02000000000000","1.02200000000000","1.02400000000000","1.02600000000000","1.02800000000000","1.03000000000000","1.03200000000000","1.03400000000000","1.03600000000000","1.03800000000000","1.04000000000000","1.04200000000000","1.04400000000000","1.04600000000000","1.04800000000000","1.05000000000000","1.05200000000000","1.05400000000000","1.05600000000000","1.05800000000000","1.06000000000000","1.06200000000000","1.06400000000000","1.06600000000000","1.06800000000000","1.07000000000000","1.07200000000000","1.07400000000000","1.07600000000000","1.07800000000000","1.08000000000000","1.08200000000000","1.08400000000000","1.08600000000000","1.08800000000000","1.09000000000000","1.09200000000000","1.09400000000000","1.09600000000000","1.09800000000000","1.10000000000000","1.10200000000000","1.10400000000000","1.10600000000000","1.10800000000000","1.11000000000000","1.11200000000000","1.11400000000000","1.11600000000000","1.11800000000000","1.12000000000000","1.12200000000000","1.12400000000000","1.12600000000000","1.12800000000000","1.13000000000000","1.13200000000000","1.13400000000000","1.13600000000000","1.13800000000000","1.14000000000000","1.14200000000000","1.14400000000000","1.14600000000000","1.14800000000000","1.15000000000000","1.15200000000000","1.15400000000000","1.15600000000000","1.15800000000000","1.16000000000000","1.16200000000000","1.16400000000000","1.16600000000000","1.16800000000000","1.17000000000000","1.17200000000000","1.17400000000000","1.17600000000000","1.17800000000000","1.18000000000000","1.18200000000000","1.18400000000000","1.18600000000000","1.18800000000000","1.19000000000000","1.19200000000000","1.19400000000000","1.19600000000000","1.19800000000000","1.20000000000000","1.20200000000000","1.20400000000000","1.20600000000000","1.20800000000000","1.21000000000000","1.21200000000000","1.21400000000000","1.21600000000000","1.21800000000000","1.22000000000000","1.22200000000000","1.22400000000000","1.22600000000000","1.22800000000000","1.23000000000000","1.23200000000000","1.23400000000000","1.23600000000000","1.23800000000000","1.24000000000000","1.24200000000000","1.24400000000000","1.24600000000000","1.24800000000000","1.25000000000000","1.25200000000000","1.25400000000000","1.25600000000000","1.25800000000000","1.26000000000000","1.26200000000000","1.26400000000000","1.26600000000000","1.26800000000000","1.27000000000000","1.27200000000000","1.27400000000000","1.27600000000000","1.27800000000000","1.28000000000000","1.28200000000000","1.28400000000000","1.28600000000000","1.28800000000000","1.29000000000000","1.29200000000000","1.29400000000000","1.29600000000000","1.29800000000000","1.30000000000000","1.30200000000000","1.30400000000000","1.30600000000000","1.30800000000000","1.31000000000000","1.31200000000000","1.31400000000000","1.31600000000000","1.31800000000000","1.32000000000000","1.32200000000000","1.32400000000000","1.32600000000000","1.32800000000000","1.33000000000000","1.33200000000000","1.33400000000000","1.33600000000000","1.33800000000000","1.34000000000000","1.34200000000000","1.34400000000000","1.34600000000000","1.34800000000000","1.35000000000000","1.35200000000000","1.35400000000000","1.35600000000000","1.35800000000000","1.36000000000000","1.36200000000000","1.36400000000000","1.36600000000000","1.36800000000000","1.37000000000000","1.37200000000000","1.37400000000000","1.37600000000000","1.37800000000000","1.38000000000000","1.38200000000000","1.38400000000000","1.38600000000000","1.38800000000000","1.39000000000000","1.39200000000000","1.39400000000000","1.39600000000000","1.39800000000000","1.40000000000000","1.40200000000000","1.40400000000000","1.40600000000000","1.40800000000000","1.41000000000000","1.41200000000000","1.41400000000000","1.41600000000000","1.41800000000000","1.42000000000000","1.42200000000000","1.42400000000000","1.42600000000000","1.42800000000000","1.43000000000000","1.43200000000000","1.43400000000000","1.43600000000000","1.43800000000000","1.44000000000000","1.44200000000000","1.44400000000000","1.44600000000000","1.44800000000000","1.45000000000000","1.45200000000000","1.45400000000000","1.45600000000000","1.45800000000000","1.46000000000000","1.46200000000000","1.46400000000000","1.46600000000000","1.46800000000000","1.47000000000000","1.47200000000000","1.47400000000000","1.47600000000000","1.47800000000000","1.48000000000000","1.48200000000000","1.48400000000000","1.48600000000000","1.48800000000000","1.49000000000000","1.49200000000000","1.49400000000000","1.49600000000000","1.49800000000000","1.50000000000000"],"animate":true,"label":"y0","display_value":true},{"control_type":"slider","default":0,"var":"order","width":null,"vals":["1","2","3","4","5","6","7","8","9","10"],"animate":true,"label":"order","display_value":true}]}}︡
︠d0846da7-3d67-4c49-bffa-83bcc686001d︠









