︠cf6a278d-719a-452f-9794-c801e762e466︠
import scipy.linalg as lin
var('t')
def rotell(sig,umat,t,offset=0):
    temp = matrix(umat)*matrix(2,1,[sig[0]*cos(t),sig[1]*sin(t)])
    return [offset+temp[0][0],temp[1][0]]
@interact
def svd_vis(a11=slider(-1,1,.05,1),a12=slider(-1,1,.05,1),a21=slider(-1,1,.05,0),a22=slider(-1,1,.05,1),ofs= ('offset image from domain',False)):
    rf_low = RealField(12)
    my_mat = matrix(rf_low,2,2,[a11,a12,a21,a22])
    u,s,vh = lin.svd(my_mat.numpy())
    if ofs: 
        offset = 3
        fsize = 6
        colors = [(1,0,0),(0,0,1),(1,0,0),(0,0,1)]
    else: 
        offset = 0
        fsize = 5
        colors = [(1,0,0),(0,0,1),(.7,.2,0),(0,.3,.7)]
    vvects = sum([arrow([0,0],matrix(vh).row(i),rgbcolor = colors[i]) for i in (0,1)])    
    uvects = Graphics()
    for i in (0,1):
        if s[i] != 0: uvects += arrow([offset,0],vector([offset,0])+matrix(s*u).column(i),rgbcolor = colors[i+2])
    html('<h3>Singular value decomposition: image of the unit circle and the singular vectors</h3>')
    html("$A = %s  = %s %s %s$"%(latex(my_mat), latex(matrix(rf_low,u.tolist())), latex(matrix(rf_low,2,2,[s[0],0,0,s[1]])), latex(matrix(rf_low,vh.tolist())))) 
    image_ell = parametric_plot(rotell(s,u,t, offset),(0,2*pi))
    graph_stuff=circle((0,0),1)+image_ell+vvects+uvects
    graph_stuff.set_aspect_ratio(1)
    show(graph_stuff,frame = False,axes=False,figsize=[fsize,fsize])
︡9aa062ff-0942-4413-8a76-487eb4b8847b︡{"stdout":"t\n"}︡{"interact":{"style":"None","flicker":false,"layout":[[["a11",12,null]],[["a12",12,null]],[["a21",12,null]],[["a22",12,null]],[["ofs",12,null]],[["",12,null]]],"id":"0a92836e-0258-4298-86f7-232340df1f4d","controls":[{"control_type":"slider","default":40,"var":"a11","width":null,"vals":["-1.00000000000000","-0.950000000000000","-0.900000000000000","-0.850000000000000","-0.800000000000000","-0.750000000000000","-0.700000000000000","-0.650000000000000","-0.600000000000000","-0.550000000000000","-0.500000000000000","-0.450000000000000","-0.400000000000000","-0.350000000000000","-0.300000000000000","-0.250000000000000","-0.200000000000000","-0.150000000000000","-0.0999999999999997","-0.0499999999999997","3.19189119579733e-16","0.0500000000000003","0.100000000000000","0.150000000000000","0.200000000000000","0.250000000000000","0.300000000000000","0.350000000000000","0.400000000000000","0.450000000000000","0.500000000000000","0.550000000000000","0.600000000000000","0.650000000000000","0.700000000000001","0.750000000000001","0.800000000000001","0.850000000000001","0.900000000000001","0.950000000000001","1.00000000000000"],"animate":true,"label":"a11","display_value":true},{"control_type":"slider","default":40,"var":"a12","width":null,"vals":["-1.00000000000000","-0.950000000000000","-0.900000000000000","-0.850000000000000","-0.800000000000000","-0.750000000000000","-0.700000000000000","-0.650000000000000","-0.600000000000000","-0.550000000000000","-0.500000000000000","-0.450000000000000","-0.400000000000000","-0.350000000000000","-0.300000000000000","-0.250000000000000","-0.200000000000000","-0.150000000000000","-0.0999999999999997","-0.0499999999999997","3.19189119579733e-16","0.0500000000000003","0.100000000000000","0.150000000000000","0.200000000000000","0.250000000000000","0.300000000000000","0.350000000000000","0.400000000000000","0.450000000000000","0.500000000000000","0.550000000000000","0.600000000000000","0.650000000000000","0.700000000000001","0.750000000000001","0.800000000000001","0.850000000000001","0.900000000000001","0.950000000000001","1.00000000000000"],"animate":true,"label":"a12","display_value":true},{"control_type":"slider","default":20,"var":"a21","width":null,"vals":["-1.00000000000000","-0.950000000000000","-0.900000000000000","-0.850000000000000","-0.800000000000000","-0.750000000000000","-0.700000000000000","-0.650000000000000","-0.600000000000000","-0.550000000000000","-0.500000000000000","-0.450000000000000","-0.400000000000000","-0.350000000000000","-0.300000000000000","-0.250000000000000","-0.200000000000000","-0.150000000000000","-0.0999999999999997","-0.0499999999999997","3.19189119579733e-16","0.0500000000000003","0.100000000000000","0.150000000000000","0.200000000000000","0.250000000000000","0.300000000000000","0.350000000000000","0.400000000000000","0.450000000000000","0.500000000000000","0.550000000000000","0.600000000000000","0.650000000000000","0.700000000000001","0.750000000000001","0.800000000000001","0.850000000000001","0.900000000000001","0.950000000000001","1.00000000000000"],"animate":true,"label":"a21","display_value":true},{"control_type":"slider","default":40,"var":"a22","width":null,"vals":["-1.00000000000000","-0.950000000000000","-0.900000000000000","-0.850000000000000","-0.800000000000000","-0.750000000000000","-0.700000000000000","-0.650000000000000","-0.600000000000000","-0.550000000000000","-0.500000000000000","-0.450000000000000","-0.400000000000000","-0.350000000000000","-0.300000000000000","-0.250000000000000","-0.200000000000000","-0.150000000000000","-0.0999999999999997","-0.0499999999999997","3.19189119579733e-16","0.0500000000000003","0.100000000000000","0.150000000000000","0.200000000000000","0.250000000000000","0.300000000000000","0.350000000000000","0.400000000000000","0.450000000000000","0.500000000000000","0.550000000000000","0.600000000000000","0.650000000000000","0.700000000000001","0.750000000000001","0.800000000000001","0.850000000000001","0.900000000000001","0.950000000000001","1.00000000000000"],"animate":true,"label":"a22","display_value":true},{"default":false,"var":"ofs","readonly":false,"control_type":"checkbox","label":"offset image from domain"}]}}︡
︠eb2d7741-24bf-4635-9f61-76e7383adc67︠









